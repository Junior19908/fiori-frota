<mvc:View
  controllerName="com.skysinc.frota.frota.controller.Main"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:table="sap.ui.table"
  displayBlock="true">

  <Page id="page" showHeader="false">
    <content>
      <!-- Barra superior remodelada -->
      <core:Fragment fragmentName="com.skysinc.frota.frota.fragments.FleetDashboardHeader" type="XML"/>

      <!-- Tabela principal -->
      <table:Table
          id="tbl"
          selectionMode="None"
          visibleRowCountMode="Auto"
          minAutoRowCount="8"
          alternateRowColors="true"
          enableColumnReordering="true"
          fixedColumnCount="4"
          width="100%"
          noData="Sem dados para o Período/filtragem."
          rows="{vm>/veiculos}">

        <table:columns>

          <table:Column sortProperty="equnr" width="5rem">
            <Label text="Veículo"/>
            <table:template>
              <Text text="{vm>equnr}"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="CATEGORIA" width="10rem">
            <Label text="Categoria"/>
            <table:template>
              <Text text="{vm>CATEGORIA}"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="eqktx" width="10rem">
            <Label text="Descrição do Veículo"/>
            <table:template>
              <Text text="{vm>eqktx}" maxLines="2"/>
            </table:template>
          </table:Column>

          <table:Column width="8rem" hAlign="Center">
            <Label text="Ações"/>
            <table:template>
              <HBox alignItems="Center" justifyContent="Center">
                <Button icon="sap-icon://detail-view" type="Transparent" tooltip="Materiais/serviços" press=".onOpenMateriais"/>
                <Button icon="sap-icon://mileage" type="Transparent" tooltip="Abastecimentos" press=".onOpenAbastecimentos"/>
				<Button icon="sap-icon://enablement" type="Transparent" tooltip="Odens de serviço" press=".onOpenOSDialog"/>
                <Button icon="sap-icon://insurance-car" type="Transparent" tooltip="Histórico" press=".onOpenHistorico"/>
              </HBox>
            </table:template>
          </table:Column>

          <!-- Agregados do Período -->
          <table:Column sortProperty="totalValor" width="7rem" hAlign="End">
            <Label text="Custo material/serviço (R$)"/>
            <table:template>
              <Text text="{ path: 'vm>totalValor', formatter: '.formatter.currencyBRL' }"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="combustivelLitrosAgg" width="7rem" hAlign="End">
            <Label text="combustível (L)"/>
            <table:template>
              <Text text="{path:'vm>combustivelLitrosAgg', formatter:'.formatter.fmtLitros'}"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="combustivelValorAgg" width="7rem" hAlign="End">
            <Label text="combustível (R$)"/>
            <table:template>
              <Text text="{path:'vm>combustivelValorAgg', formatter:'.formatter.fmtBrl'}"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="custoTotalAgg" width="7rem" hAlign="End">
            <Label text="Custo total (R$)"/>
            <table:template>
              <Text text="{
                parts:['vm>totalValor','vm>combustivelValorAgg'],
                formatter: '.formatter.fmtSomaBrl'
              }"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="kmRodadosAgg" width="6rem" hAlign="End">
            <Label text="Km rodados"/>
            <table:template>
              <Text text="{path:'vm>kmRodadosAgg', formatter:'.formatter.fmtKm'}"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="hrRodadosAgg" width="6rem" hAlign="End">
            <Label text="Hr rodados"/>
            <table:template>
              <Text text="{path:'vm>hrRodadosAgg', formatter:'.formatter.fmtNum'}"/>
            </table:template>
          </table:Column>
          <!-- Média por Veículo: km/L -->
          <table:Column width="6rem" hAlign="End">
            <Label text="Média (km/L)"/>
            <table:template>
              <Text text="{
                parts: ['vm>kmRodadosAgg', 'vm>combustivelLitrosAgg'],
                formatter: '.formatter.fmtKmPorLitro'
              }"/>
            </table:template>
          </table:Column>

          <!-- Consumo por Veículo: L/h -->
          <table:Column width="6rem" hAlign="End">
            <Label text="Média (L/h)"/>
            <table:template>
              <Text text="{
                parts: ['vm>combustivelLitrosAgg', 'vm>hrRodadosAgg'],
                formatter: '.formatter.fmtLitrosPorHora'
              }"/>
            </table:template>
          </table:Column>

          <!-- Ordem das Colunas -->
          <!-- Coluna Hr Paradas -->
          <!-- Coluna Disponibilidade/Indisponibilidade -->
          <!-- Coluna Nº Paradas -->
          <!-- Coluna Tipo de Ordem <Essa coluna precisa ser no Fragment de OS> -->
          <!-- Coluna MTBF <Essa coluna precisa ser no Fragment de OS> -->
          <!-- Coluna MTTR <Essa coluna precisa ser no Fragment de OS> -->
          <!-- Coluna KM até a quebra -->
          <!-- Coluna HR até a quebra -->

          <table:Column width="6rem" hAlign="End">
            <Label text="Hr Paradas (Teste)"/>
            <table:template>
              <Text text="{ path:'vm>totalHorasIndisponiveis', formatter: '.formatter.formatacaoHorasNovo'  }"/>
            </table:template>
          </table:Column>

          <table:Column sortProperty="pctDisp" width="16rem" hAlign="Center">
            <Label
              text="Disponibilidade"
              tooltip="Disponibilidade (%) = 100 - Indisponibilidade (%). Indisponibilidade (%) = (Horas em OS / Total de horas do período) x 100."/>
            <table:template>
              <ObjectStatus
                text="{
                        parts:['vm>pctDisp','vm>pctIndisp'],
                        formatter: '.formatter.fmtDisponibilidade'
                      }"
                state="{ path:'vm>pctDisp', formatter:'.formatter.stateDisponibilidade' }"
                tooltip="{
                  parts: [
                    { path: 'vm>pctDisp' },
                    { path: 'vm>pctIndisp' },
                    { path: 'vm>totalHorasPeriodo' },
                    { path: 'vm>totalHorasIndisponiveis' },
                    { path: 'vm>totalHorasDisponiveis' }
                  ],
                  formatter: '.formatter.fmtDisponibilidadeTooltip'
                }"/>
            </table:template>
          </table:Column>

          <table:Column width="6rem" hAlign="End">
            <Label text="Nº Paradas (Teste)"/>
            <table:template>
              <Text text="{vm>osCountRange}"/>
            </table:template>
          </table:Column>

          <table:Column width="6rem" hAlign="End">
            <Label text="MTBF (Teste)"/>
            <table:template>
              <Text text="0"/>
            </table:template>
          </table:Column>

          <table:Column width="6rem" hAlign="End">
            <Label text="MTTR (Teste)"/>
            <table:template>
              <Text text="0"/>
            </table:template>
          </table:Column>

          <table:Column width="6rem" hAlign="End">
            <Label text="KM (Teste)"/>
            <table:template>
              <Text text="000.000 Km"/>
            </table:template>
          </table:Column>

          <table:Column width="6rem" hAlign="End">
            <Label text="HR (Teste)"/>
            <table:template>
              <Text text="00:00:00 hr"/>
            </table:template>
          </table:Column>

        </table:columns>
      </table:Table>
    </content>
  </Page>
</mvc:View>
